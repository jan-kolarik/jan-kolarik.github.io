<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Debugging Arduino without additional hardware | kolage</title><meta name=keywords content="arduino,vscode"><meta name=description content="Using Visual Studio Code to debug programs for Arduino Mega 2560"><meta name=author content><link rel=canonical href=https://jan-kolarik.github.io/posts/atmega-debug-linux/><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://jan-kolarik.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://jan-kolarik.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://jan-kolarik.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://jan-kolarik.github.io/apple-touch-icon.png><link rel=mask-icon href=https://jan-kolarik.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Debugging Arduino without additional hardware"><meta property="og:description" content="Using Visual Studio Code to debug programs for Arduino Mega 2560"><meta property="og:type" content="article"><meta property="og:url" content="https://jan-kolarik.github.io/posts/atmega-debug-linux/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-02-16T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-16T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Debugging Arduino without additional hardware"><meta name=twitter:description content="Using Visual Studio Code to debug programs for Arduino Mega 2560"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://jan-kolarik.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Debugging Arduino without additional hardware","item":"https://jan-kolarik.github.io/posts/atmega-debug-linux/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Debugging Arduino without additional hardware","name":"Debugging Arduino without additional hardware","description":"Using Visual Studio Code to debug programs for Arduino Mega 2560","keywords":["arduino","vscode"],"articleBody":" Intro On a bit different note, recently I was trying to help my father with adding debugging support for Arduino Mega 2560 microcontroller board without need to use any additional hardware kit.\nFor Windows, there is a great tutorial for that, but we need to setup several things differently in the Linux environment and I didn’t find any easy-to-use guide for that.\nSo I want to share my approach with you, definitely nothing world-shattering, but could be useful for anyone with similar intention or might save you some time from being stuck in one place for too long.\nEnvironment Fedora Linux (but should be applicable to any other distro) Visual Studio Code + Arduino extension Arduino CLI avr_debug Building and uploading First we need to setup the building of our project and make it possible to upload the binary into the board.\nPrepare VS Code Install the Arduino CLI tool to provide an all-in-one solution for Arduino boards.\nThen we need to install \u0026 enable the Arduino extension in the VS Code. In the extension’s configuration we need to modify some fields:\nArduino: Command Path (arduino.commandPath) – set arduino-cli Arduino: Path (arduino.path) – set /path/to/your/arduino-cli/binary Arduino: Use Arduino Cli (arduino.useArduinoCli) – set true Initialize the Arduino project with the Arduino: Initialize command, f.e. by selecting it from the command palette using the F1 key in VS Code. This will generate the empty .ino source file and the default arduino.json extension config for our project in the .vscode folder. You will also need to rename this existing .ino file to match the name of the project.\nOpen the Arduino: Board Manager command and install the Arduino AVR Boards package to add support for our microcontroller board.\nUsing the bottom status bar in VS Code, select the Arduino Mega board type.\nNow you can try to compile the empty project using the Arduino: Verify command which is also available under the icon in the editor’s top bar.\nDeploy a simple program To be able to upload our program to the actual board, it might be needed to add appropriate user rights by adding the current user to the dialout or tty group:\nsudo usermod -a -G dialout $USER It will need a logout or restart.\nConnect the board to the USB and select the /dev/ttyUSB0 port from the bottom status bar.\nWe should be able now to upload the program to the board with the Arduino: Upload command.\nTo see if it is really working you can add some simple blinking to the .ino source:\nvoid setup() { pinMode(LED_BUILTIN, OUTPUT); } void loop() { digitalWrite(LED_BUILTIN, HIGH); delay(1000); digitalWrite(LED_BUILTIN, LOW); delay(1000); } Debugging Here we’ll add support for debugging our board from the VS Code using just the connected USB cable.\nSetup the debugger We will prepare the GDB debugger that will be running on our local computer and the avr_debug, remote stub which will be deployed to the ATMega and communicating with the GDB to allow debugging from VS Code.\nUnfortunately, for Fedora Linux, there is no maintained package with GDB for AVR architectures anymore, therefore we need to build it by ourselves. Luckily it’s very simple.\nDownload the latest GDB sources, compile it for target AVR architecture and install it in the defined directory like this:\n./configure --target=avr --prefix=${HOME}/Programs/avr-gdb make make install Then unpack the avr_debug library into the Arduino user libraries directory at ${HOME}/Arduino/libraries/avr-debugger. Put there just the library sub-directory from the default branch.\nConfigure the project Include the debugging library into our project by going to the Arduino: Library Manager, filtering the avr-debugger and clicking the Include Library button.\nNow we have the sources prepared for adding the debugging support which is as simple as adding the debug_init() function at the beginning of the setup():\n#include #include #include void setup() { debug_init(); pinMode(LED_BUILTIN, OUTPUT); } void loop() { digitalWrite(LED_BUILTIN, HIGH); delay(1000); digitalWrite(LED_BUILTIN, LOW); delay(1000); } Last thing we need to do is to create a debugging configuration for VS Code, so it knows what we want to debug and how.\nI am sharing my launch.json example below. The key parts there:\nprogram points to our built program which is the .elf binary in the build folder miDebuggerPath addresses the AVR GDB binary we have built setupCommands section tells GDB what port and baud rate to use { \"version\": \"0.2.0\", \"configurations\": [ { \"name\": \"Debugger launch\", \"type\": \"cppdbg\", \"request\": \"launch\", \"program\": \"${workspaceFolder}/build/example.ino.elf\", \"cwd\": \"${workspaceFolder}\", \"externalConsole\": true, \"MIMode\": \"gdb\", \"miDebuggerPath\": \"${userHome}/Programs/avr-gdb/bin/avr-gdb\", \"setupCommands\": [ { \"description\": \"Set remote serial baud\", \"text\": \"set serial baud 115200\", \"ignoreFailures\": false }, { \"description\": \"Attach to serial port\", \"text\": \"target remote /dev/ttyUSB0\", \"ignoreFailures\": false } ] } ] } You can put it in the .vscode subfolder and modify it according to your environment.\nLet’s add some breakpoints! And so now we can verify and upload our program and then debug the running program in VS Code as with any other project. Just setup the breakpoints and then attach to the board using the Run and Debug from the Activity Bar.\nNote: there is one important downside of this approach and it’s that no Serial functions could be used when the debugging stub is attached. You could use the conditional compilation to enable them when not debugging. For more info, refer to the upstream project of the avr_debug author.\n","wordCount":"886","inLanguage":"en","datePublished":"2023-02-16T00:00:00Z","dateModified":"2023-02-16T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://jan-kolarik.github.io/posts/atmega-debug-linux/"},"publisher":{"@type":"Organization","name":"kolage","logo":{"@type":"ImageObject","url":"https://jan-kolarik.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://jan-kolarik.github.io/ accesskey=h title="kolage (Alt + H)">kolage</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://jan-kolarik.github.io/archives title=Archive><span>Archive</span></a></li><li><a href=https://jan-kolarik.github.io/tags title=Tags><span>Tags</span></a></li><li><a href=https://jan-kolarik.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://jan-kolarik.github.io/about title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Debugging Arduino without additional hardware</h1><div class=post-meta><span title='2023-02-16 00:00:00 +0000 UTC'>February 16, 2023</span>&nbsp;·&nbsp;5 min</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#intro aria-label=Intro>Intro</a></li><li><a href=#environment aria-label=Environment>Environment</a></li><li><a href=#building-and-uploading aria-label="Building and uploading">Building and uploading</a><ul><li><a href=#prepare-vs-code aria-label="Prepare VS Code">Prepare VS Code</a></li><li><a href=#deploy-a-simple-program aria-label="Deploy a simple program">Deploy a simple program</a></li></ul></li><li><a href=#debugging aria-label=Debugging>Debugging</a><ul><li><a href=#setup-the-debugger aria-label="Setup the debugger">Setup the debugger</a></li><li><a href=#configure-the-project aria-label="Configure the project">Configure the project</a></li><li><a href=#lets-add-some-breakpoints aria-label="Let&amp;rsquo;s add some breakpoints!">Let&rsquo;s add some breakpoints!</a></li></ul></li></ul></div></details></div><div class=post-content><p><img loading=lazy src=/posts/images/arduino-logo.png alt=arduino-logo title="Arduino logo"></p><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><p>On a bit different note, recently I was trying to help my father with adding
debugging support for Arduino Mega 2560 microcontroller board without need
to use any additional hardware kit.</p><p>For Windows, there is a great <a href=https://www.codeproject.com/Articles/5150391/Creating-and-Debugging-Arduino-Programs-in-Visual>tutorial</a> for that, but we need to setup several things differently in the Linux environment
and I didn&rsquo;t find any easy-to-use guide for that.</p><p>So I want to share my approach with you, definitely nothing world-shattering, but could be useful for anyone with
similar intention or might save you some time from being stuck in one place for too long.</p><hr><h2 id=environment>Environment<a hidden class=anchor aria-hidden=true href=#environment>#</a></h2><ul><li>Fedora Linux (but should be applicable to any other distro)</li><li><a href=https://code.visualstudio.com/>Visual Studio Code</a> + Arduino extension</li><li><a href=https://github.com/arduino/arduino-cli>Arduino CLI</a></li><li><a href=https://github.com/jdolinay/avr_debug>avr_debug</a></li></ul><hr><h2 id=building-and-uploading>Building and uploading<a hidden class=anchor aria-hidden=true href=#building-and-uploading>#</a></h2><p>First we need to setup the building of our project and make it possible
to upload the binary into the board.</p><h3 id=prepare-vs-code>Prepare VS Code<a hidden class=anchor aria-hidden=true href=#prepare-vs-code>#</a></h3><p>Install the <strong>Arduino CLI</strong> tool to provide an all-in-one solution for
Arduino boards.</p><p>Then we need to install & enable the <strong>Arduino</strong> extension in the VS Code.
In the extension&rsquo;s configuration we need to modify some fields:</p><ul><li>Arduino: Command Path (<code>arduino.commandPath</code>) &ndash; set <code>arduino-cli</code></li><li>Arduino: Path (<code>arduino.path</code>) &ndash; set <code>/path/to/your/arduino-cli/binary</code></li><li>Arduino: Use Arduino Cli (<code>arduino.useArduinoCli</code>) &ndash; set <code>true</code></li></ul><p>Initialize the Arduino project with the <strong>Arduino: Initialize</strong> command, f.e.
by selecting it from the command palette using the <strong>F1</strong> key in VS Code.
This will generate the empty <code>.ino</code> source file and the default <code>arduino.json</code>
extension config for our project in the <code>.vscode</code> folder. You will also need to <strong>rename</strong>
this existing <code>.ino</code> file to match the name of the project.</p><p>Open the <strong>Arduino: Board Manager</strong> command and install the <strong>Arduino AVR Boards</strong>
package to add support for our microcontroller board.</p><p>Using the bottom status bar in VS Code, select the <strong>Arduino Mega</strong> board type.</p><p>Now you can try to compile the empty project using the <strong>Arduino: Verify</strong>
command which is also available under the icon in the editor&rsquo;s top bar.</p><h3 id=deploy-a-simple-program>Deploy a simple program<a hidden class=anchor aria-hidden=true href=#deploy-a-simple-program>#</a></h3><p>To be able to upload our program to the actual board, it might be needed
to add appropriate user rights by adding the current user to the
<code>dialout</code> or <code>tty</code> group:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo usermod -a -G dialout $USER
</span></span></code></pre></div><p>It will need a logout or restart.</p><p>Connect the board to the USB and select the <code>/dev/ttyUSB0</code> port
from the bottom status bar.</p><p>We should be able now to upload the program to the board with the
<strong>Arduino: Upload</strong> command.</p><p>To see if it is really working you can add some simple blinking
to the <code>.ino</code> source:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pinMode</span>(LED_BUILTIN, OUTPUT);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>digitalWrite</span>(LED_BUILTIN, HIGH);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>delay</span>(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>digitalWrite</span>(LED_BUILTIN, LOW);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>delay</span>(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><hr><h2 id=debugging>Debugging<a hidden class=anchor aria-hidden=true href=#debugging>#</a></h2><p>Here we&rsquo;ll add support for debugging our board from the VS Code
using just the connected USB cable.</p><h3 id=setup-the-debugger>Setup the debugger<a hidden class=anchor aria-hidden=true href=#setup-the-debugger>#</a></h3><p>We will prepare the <strong>GDB</strong> debugger that will be running on our
local computer and the <strong>avr_debug</strong>, remote stub which will be
deployed to the ATMega and communicating with the <strong>GDB</strong> to
allow debugging from VS Code.</p><p>Unfortunately, for Fedora Linux, there is no maintained package
with <strong>GDB</strong> for <strong>AVR</strong> architectures anymore, therefore we need to
build it by ourselves. Luckily it&rsquo;s very simple.</p><p>Download the latest <strong>GDB</strong> <a href=https://www.sourceware.org/gdb/download/>sources</a>,
compile it for target <strong>AVR</strong> architecture and install it in the defined
directory like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./configure --target<span style=color:#f92672>=</span>avr --prefix<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>HOME<span style=color:#e6db74>}</span>/Programs/avr-gdb
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span>make install
</span></span></code></pre></div><p>Then unpack the <strong>avr_debug</strong> library into the Arduino user libraries
directory at <code>${HOME}/Arduino/libraries/avr-debugger</code>. Put there just the
library <a href=https://github.com/jdolinay/avr_debug/tree/master/arduino/library/avr-debugger>sub-directory</a>
from the default branch.</p><h3 id=configure-the-project>Configure the project<a hidden class=anchor aria-hidden=true href=#configure-the-project>#</a></h3><p>Include the debugging library into our project by going to the
<strong>Arduino: Library Manager</strong>, filtering the <code>avr-debugger</code> and
clicking the <strong>Include Library</strong> button.</p><p>Now we have the sources prepared for adding the debugging support
which is as simple as adding the <code>debug_init()</code> function at the
beginning of the <code>setup()</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;app_api.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;avr_debugger.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;avr8-stub.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>debug_init</span>();
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>pinMode</span>(LED_BUILTIN, OUTPUT);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>digitalWrite</span>(LED_BUILTIN, HIGH);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>delay</span>(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>digitalWrite</span>(LED_BUILTIN, LOW);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>delay</span>(<span style=color:#ae81ff>1000</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Last thing we need to do is to create a debugging configuration
for VS Code, so it knows what we want to debug and how.</p><p>I am sharing my <code>launch.json</code> example below. The key parts there:</p><ul><li><code>program</code> points to our built program which is the <code>.elf</code> binary in the <code>build</code> folder</li><li><code>miDebuggerPath</code> addresses the <strong>AVR GDB</strong> binary we have built</li><li><code>setupCommands</code> section tells <strong>GDB</strong> what port and baud rate to use</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;version&#34;</span>: <span style=color:#e6db74>&#34;0.2.0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;configurations&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Debugger launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;type&#34;</span>: <span style=color:#e6db74>&#34;cppdbg&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;request&#34;</span>: <span style=color:#e6db74>&#34;launch&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;program&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}/build/example.ino.elf&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;cwd&#34;</span>: <span style=color:#e6db74>&#34;${workspaceFolder}&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;externalConsole&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;MIMode&#34;</span>: <span style=color:#e6db74>&#34;gdb&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;miDebuggerPath&#34;</span>: <span style=color:#e6db74>&#34;${userHome}/Programs/avr-gdb/bin/avr-gdb&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f92672>&#34;setupCommands&#34;</span>: [
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Set remote serial baud&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;set serial baud 115200&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;ignoreFailures&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;description&#34;</span>: <span style=color:#e6db74>&#34;Attach to serial port&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;text&#34;</span>: <span style=color:#e6db74>&#34;target remote /dev/ttyUSB0&#34;</span>,
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&#34;ignoreFailures&#34;</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>You can put it in the <code>.vscode</code> subfolder and modify it according to
your environment.</p><h3 id=lets-add-some-breakpoints>Let&rsquo;s add some breakpoints!<a hidden class=anchor aria-hidden=true href=#lets-add-some-breakpoints>#</a></h3><p>And so now we can verify and upload our program and then debug
the running program in VS Code as with any other project. Just
setup the breakpoints and then attach to the board using the
<strong>Run and Debug</strong> from the Activity Bar.</p><p><strong>Note:</strong> there is one important downside of this approach and
it&rsquo;s that no <code>Serial</code> functions could be used when the debugging stub
is attached. You could use the conditional compilation to
enable them when not debugging. For more info, refer to the
upstream project of the <strong>avr_debug</strong> author.</p><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://jan-kolarik.github.io/tags/arduino/>arduino</a></li><li><a href=https://jan-kolarik.github.io/tags/vscode/>vscode</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on twitter" href="https://twitter.com/intent/tweet/?text=Debugging%20Arduino%20without%20additional%20hardware&url=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f&hashtags=arduino%2cvscode"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f&title=Debugging%20Arduino%20without%20additional%20hardware&summary=Debugging%20Arduino%20without%20additional%20hardware&source=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f&title=Debugging%20Arduino%20without%20additional%20hardware"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on whatsapp" href="https://api.whatsapp.com/send?text=Debugging%20Arduino%20without%20additional%20hardware%20-%20https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Debugging Arduino without additional hardware on telegram" href="https://telegram.me/share/url?text=Debugging%20Arduino%20without%20additional%20hardware&url=https%3a%2f%2fjan-kolarik.github.io%2fposts%2fatmega-debug-linux%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://jan-kolarik.github.io/>kolage</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>